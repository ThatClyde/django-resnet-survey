{% extends "survey/survey_dashboard.html" %}
{% load static from staticfiles %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href='{% static "css/results.css" %}'/>
{% endblock %}

{% block content %}
<script type="text/javascript">
jQuery(document).ready(function(){
  $('.accordion .head').click(function() {
      $(this).siblings("ul").toggle('slow');
      return false;
  }).siblings("ul").hide();
});
</script>

  <a href='{% url exportresults survey.slug %}'>Export Report to Excel</a>
  {% regroup choices by question as question_list %}
    {% for question in question_list %}      
      {% if question.grouper.type == 'TB' or question.grouper.type == 'TA' %}
        <div class = "accordion">
        <label class = "head field_title_accordion">{{ question.grouper }}</label>
        <ul>
      {% else %}             
        <label class = "field_title">{{ question.grouper }}</label>
        <table border="1">
      {% endif %}

      {% for choice in question.list %}
        {% if choice.question.type == 'TB' or choice.question.type == 'TA' %}
          <li>{{ choice.message }}</li>
        {% else %}             
          <tr>
            <td {% if choice_id == choice.id %} class="field_sorted_by"{% endif %}>
              <a href="{% url surveyresults survey.slug choice.pk %}">{{ choice.message }}:</a>
            </td>
            <td>{% firstof choice.num_answers '0' %}</td>
          </tr>
        {% endif %}
      {% endfor %}

      {% if question.grouper.type == 'TB' or question.grouper.type == 'TA' %}
        </ul>
        </div>
      {% else %}             
        </table>
      {% endif %}
    {% endfor %}
  <label class = "foot_note">Note: Click on a question field to filter results.</label>

{% endblock %}
